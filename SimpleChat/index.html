<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CyberChat</title>
    <!-- å¼•å…¥Vue.js -->
    <script src="https://unpkg.com/vue@3.5.12/dist/vue.global.prod.js"></script>

    <!-- å¼•å…¥å›¾æ ‡å­—ä½“ï¼ˆè¿™é‡Œä½¿ç”¨ç¤ºä¾‹é“¾æ¥ï¼Œéœ€è¦æ›¿æ¢æˆå®é™…çš„å›¾æ ‡åº“ï¼‰ -->
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8d5l8fzk5b87iudi.css">

    <!-- å¼•å…¥æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="style.css?v=1.0.8">
</head>

<body>
    <div id="app">
        <div class="wechat-container">
            <!-- ä¸»é¡µé¢ -->
            <div class="page main-page" :class="{ 'slide-out': showChat }">
                <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
                <div class="header">
                    <div class="title">{{ getCurrentTabName }}</div>
                    <div class="icons">
                        <i class="icon-search"></i>
                        <i class="icon-add"></i>
                    </div>
                </div>



                <!-- èŠå¤©åˆ—è¡¨é¡µé¢ -->
                <div v-if="currentTab === 'wechat'" class="chat-list">
                    <div class="chat-item" v-for="chat in chats" :key="chat.id" @click="openChat(chat)">
                        <div class="avatar">
                            <img :src="chat.avatar" alt="å¤´åƒ">
                        </div>
                        <div class="content">
                            <div class="name">{{chat.name}}</div>
                            <div class="message">{{chat.lastMessage}}</div>
                        </div>
                        <div class="time">{{chat.time}}</div>
                        <div v-if="chat.unread" class="badge" :class="{ 'large': chat.unread > 99 }">
                            {{ chat.unread > 99 ? '99+' : chat.unread }}
                        </div>
                    </div>
                </div>

                <!-- é€šè®¯å½•é¡µé¢ -->
                <div v-if="currentTab === 'contacts'" class="contacts-page">
                    <!-- æœç´¢æ¡†å®¹å™¨ -->
                    <div class="search-container">
                        <div class="search-box">
                            <i class="icon-search"></i>
                            <input type="text" v-model="searchText" placeholder="æœç´¢" @input="handleSearch">
                        </div>
                    </div>

                    <!-- æ·»åŠ æœç´¢ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
                    <div class="search-results" v-if="searchText && searchResults.length">
                        <div class="contact-item" v-for="contact in searchResults" :key="contact.id"
                            @click="openContactDetail(contact)">
                            <div class="avatar">
                                <img :src="contact.avatar" alt="å¤´åƒ">
                            </div>
                            <div class="name">{{contact.name}}</div>
                        </div>
                    </div>

                    <!-- åŸè”ç³»äººåˆ—è¡¨ï¼Œå½“æ²¡æœ‰æœç´¢æ–‡æœ¬æ—¶æ˜¾ç¤º -->
                    <div class="contact-list" v-show="!searchText">
                        <!-- ç‰¹æ®Šè”ç³»äºº -->
                        <div class="special-contacts">
                            <div class="contact-item">
                                <div class="avatar special-avatar green-bg">
                                    <img src="https://api.iconify.design/material-symbols:person-add.svg?color=white&width=15"
                                        alt="æ–°çš„æœ‹å‹" class="icon-new-friend">
                                </div>
                                <div class="name">æ–°çš„æœ‹å‹</div>
                            </div>
                            <div class="contact-item">
                                <div class="avatar special-avatar green-bg">
                                    <img src="https://api.iconify.design/material-symbols:group.svg?color=white&width=18"
                                        alt="ç¾¤èŠ" class="icon-group">
                                </div>
                                <div class="name">ç¾¤èŠ</div>
                            </div>
                            <div class="contact-item">
                                <div class="avatar special-avatar green-bg">
                                    <img src="https://api.iconify.design/material-symbols:sell.svg?color=white&width=14"
                                        alt="æ ‡ç­¾" class="icon-tag">
                                </div>
                                <div class="name">æ ‡ç­¾</div>
                            </div>
                            <div class="contact-item">
                                <div class="avatar special-avatar green-bg">
                                    <img src="https://api.iconify.design/material-symbols:chrome-reader-mode.svg?color=white&width=16"
                                        alt="å…¬ä¼—å·" class="icon-official">
                                </div>
                                <div class="name">å…¬ä¼—å·</div>
                            </div>
                        </div>

                        <!-- è”ç³»äººåˆ—è¡¨ -->
                        <div class="contact-section" v-for="section in contactSections" :key="section.letter"
                            :data-letter="section.letter">
                            <div class="section-title">{{section.letter}}</div>
                            <div class="contact-item" v-for="contact in section.contacts" :key="contact.id"
                                @click="openContactDetail(contact)">
                                <div class="avatar">
                                    <img :src="contact.avatar" alt="å¤´åƒ">
                                </div>
                                <div class="name">{{contact.name}}</div>
                            </div>
                        </div>
                    </div>

                    <!-- å­—æ¯ç´¢å¼• -->
                    <div class="letter-index">
                        <span v-for="letter in letters" :key="letter" @click="scrollToLetter(letter)"
                            @touchstart="handleLetterTouchStart($event, letter)" @touchmove.prevent>{{letter}}</span>
                    </div>
                </div>

                <!-- å‘ç°é¡µé¢ -->
                <div v-if="currentTab === 'discover'" class="discover-page">
                    <div class="discover-list">
                        <!-- æœ‹å‹åœˆå’Œè§†é¢‘å· -->
                        <div class="discover-section">
                            <div class="discover-item" @click="openMoments">
                                <img src="https://api.iconify.design/material-symbols:camera.svg?color=%23FF9C0B"
                                    alt="æœ‹å‹åœˆ" class="discover-icon">
                                <span>æœ‹å‹åœˆ</span>
                                <i class="icon-arrow"></i>
                            </div>
                            <div class="discover-item">
                                <img src="https://api.iconify.design/material-symbols:play-circle.svg?color=%23FA9D3B"
                                    alt="é¢‘å·" class="discover-icon">
                                <span>è§†é¢‘å·</span>
                                <i class="icon-arrow"></i>
                            </div>
                        </div>

                        <!-- AIåˆ›ä½œèƒ½åŠ›å…¥å£ -->
                        <div class="discover-section">
                            <div class="discover-item" @click="openDrawPage">
                                <img src="https://api.iconify.design/material-symbols:brush.svg?color=%23FF6B6B"
                                    alt="ç”»ä¸€ç”»" class="discover-icon">
                                <span>ç”»ä¸€ç”»</span>
                                <i class="icon-arrow"></i>
                            </div>
                            <div class="discover-item">
                                <img src="https://api.iconify.design/material-symbols:edit-note.svg?color=%234A90E2"
                                    alt="å†™ä¸€å†™" class="discover-icon">
                                <span>å†™ä¸€å†™</span>
                                <i class="icon-arrow"></i>
                            </div>
                            <div class="discover-item">
                                <img src="https://api.iconify.design/material-symbols:music-note.svg?color=%23FFB900"
                                    alt="å”±ä¸€å”±" class="discover-icon">
                                <span>å”±ä¸€å”±</span>
                                <i class="icon-arrow"></i>
                            </div>
                            <div class="discover-item">
                                <img src="https://api.iconify.design/material-symbols:fiber-smart-record.svg?color=%23B066FF"
                                    alt="å½•ä¸€å½•" class="discover-icon">
                                <span>å½•ä¸€å½•</span>
                                <i class="icon-arrow"></i>
                            </div>
                        </div>

                        <!-- æ‰«ä¸€æ‰«å’Œæ‘‡ä¸€æ‘‡éƒ¨åˆ† -->
                        <div class="discover-section">
                            <div class="discover-item">
                                <img src="https://api.iconify.design/material-symbols:qr-code-scanner.svg?color=%2307C160"
                                    alt="æ‰«ä¸€æ‰«" class="discover-icon">
                                <span>æ‰«ä¸€æ‰«</span>
                                <i class="icon-arrow"></i>
                            </div>
                            <div class="discover-item">
                                <img src="https://api.iconify.design/material-symbols:vibration.svg?color=%2307C160"
                                    alt="æ‘‡ä¸€æ‘‡" class="discover-icon">
                                <span>æ‘‡ä¸€æ‘‡</span>
                                <i class="icon-arrow"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æˆ‘çš„é¡µé¢ -->
                <div v-if="currentTab === 'me'" class="me-page">
                    <div class="user-info">
                        <div class="avatar">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=User" alt="å¤´åƒ">
                        </div>
                        <div class="info">
                            <div class="name">ç”¨æˆ·å</div>
                            <div class="wxid">å¾®ä¿¡å·ï¼šwxid_xxx</div>
                        </div>
                        <div class="qr-code">
                            <i class="icon-qr"></i>
                        </div>
                        <i class="icon-arrow"></i>
                    </div>
                    <div class="me-section">
                        <div class="me-item">
                            <i class="icon-pay"></i>
                            <span>æ”¯ä»˜</span>
                            <i class="icon-arrow"></i>
                        </div>
                    </div>
                    <div class="me-section">
                        <div class="me-item">
                            <i class="icon-favorites"></i>
                            <span>æ”¶è—</span>
                            <i class="icon-arrow"></i>
                        </div>
                        <div class="me-item">
                            <i class="icon-albums"></i>
                            <span>ç›¸å†Œ</span>
                            <i class="icon-arrow"></i>
                        </div>
                        <div class="me-item">
                            <i class="icon-cards"></i>
                            <span>å¡åŒ…</span>
                            <i class="icon-arrow"></i>
                        </div>
                        <div class="me-item">
                            <i class="icon-sticker"></i>
                            <span>è¡¨æƒ…</span>
                            <i class="icon-arrow"></i>
                        </div>
                    </div>
                    <div class="me-section">
                        <div class="me-item">
                            <i class="icon-settings"></i>
                            <span>è®¾ç½®</span>
                            <i class="icon-arrow"></i>
                        </div>
                    </div>
                </div>


                <!-- åº•éƒ¨å¯¼èˆªæ  -->
                <div class="tab-bar">
                    <div v-for="tab in tabs" :key="tab.id" class="tab-item" :class="{ 'active': currentTab === tab.id }"
                        @click="switchTab(tab.id)">
                        <i :class="tab.icon"></i>
                        <span>{{ tab.name }}</span>
                        <span v-if="tab.unread" class="badge">{{ tab.unread }}</span>
                        <span v-if="tab.hasNew" class="dot"></span>
                    </div>
                </div>




            </div>

            <!-- èŠå¤©è¯¦æƒ…é¡µé¢ -->
            <div class="page chat-page" :class="{ 'slide-in': showChat }">
                <div class="header">
                    <div class="back-button" @click="goBack">
                        <!-- ç§»é™¤å›¾æ ‡å­—ä½“ï¼Œä½¿ç”¨ CSS ç»˜åˆ¶çš„ç®­å¤´ -->
                    </div>
                    <div class="title">{{ currentChat?.name }}</div>
                    <div class="icons">
                        <i class="icon-more"></i>
                    </div>
                </div>
                <div class="chat-content">
                    <div class="chat-messages" v-if="currentChat && currentChat.messages && currentChat.messages.length">
                        <div v-for="msg in currentChat.messages" :key="msg.id" class="message-item" :class="{ 'self': msg.isSelf }">
                            <!-- æ·»åŠ å‘é€è€…å¤´åƒ -->
                            <img :src="msg.isSelf ? 'https://api.dicebear.com/7.x/avataaars/svg?seed=User' : currentChat.avatar" class="message-avatar">
                            <!-- æ¶ˆæ¯å†…å®¹å®¹å™¨ -->
                            <div class="message-content">
                                <img v-if="msg.type === 'image'" :src="msg.content" class="message-image" @click="previewImage(msg.content)">
                                <span v-else>{{ msg.content }}</span>
                            </div>
                        </div>
                    </div>
                    <div v-else class="message-hint">æš‚æ— èŠå¤©è®°å½•</div>
                </div>

                <!-- ä¿®æ”¹èŠå¤©è¾“å…¥æ¡†åŒºåŸŸ -->
                <div class="chat-input-area">
                    <div class="input-toolbar">
                        <label class="upload-btn">
                            <img src="./assert/add.png" alt="å›¾ç‰‡" class="icon-image">
                            <input type="file" accept="image/*" @change="handleImageSelect" multiple
                                style="display: none;">
                        </label>
                    </div>
                    <div class="input-box">
                        <input type="text" v-model="messageText" placeholder="è¾“å…¥æ¶ˆæ¯..." @keyup.enter="sendMessage">
                        <div class="image-preview-container" v-if="selectedImages.length">
                            <div class="image-preview" v-for="(image, index) in selectedImages" :key="index">
                                <img :src="image" alt="é¢„è§ˆå›¾ç‰‡">
                                <span class="icon-close" @click="cancelImage(index)"></span>
                            </div>
                        </div>
                    </div>

                    <button class="send-btn" :class="{ active: messageText.trim() || selectedImages.length }"
                        @click="sendMessage">å‘é€</button>
                </div>
            </div>

            <!-- è”äººè¯¦æƒ…é¡µé¢ -->
            <div class="page contact-detail-page" :class="{ 'slide-in': showContactDetail }">
                <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
                <div class="header">
                    <div class="back-button" @click="closeContactDetail">
                        <span class="back-arrow"></span>
                    </div>
                    <div class="title">è¯¦ç»†èµ„æ–™</div>
                </div>

                <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
                <div class="contact-detail-content">
                    <div class="info-card">
                        <div class="avatar-large">
                            <img :src="currentContact?.avatar" alt="å¤´åƒ">
                        </div>
                        <div class="info-main">
                            <div class="name">{{ currentContact?.name }}</div>
                            <div class="wxid">å¾®ä¿¡å·ï¼š{{ currentContact?.wxid || 'wxid_' + currentContact?.name }}</div>
                        </div>
                    </div>

                    <!-- è¯¦ç»†ä¿¡æ¯åˆ—è¡¨ -->
                    <div class="detail-list">
                        <div class="detail-item">
                            <span class="label">å¤‡æ³¨</span>
                            <span class="value">{{ currentContact?.remark || 'è®¾ç½®å¤‡æ³¨' }}</span>
                            <i class="icon-arrow"></i>
                        </div>
                        <div class="detail-item">
                            <span class="label">åœ°åŒº</span>
                            <span class="value">{{ currentContact?.region || 'æœªè®¾ç½®' }}</span>
                        </div>
                    </div>
                </div>

                <!-- åº•éƒ¨æ“ä½œé’® -->
                <div class="bottom-actions">
                    <div class="action-buttons">
                        <div class="action-btn" @click="startChat(currentContact)">
                            <div class="icon-wrapper">
                                <i class="icon-message"></i>
                            </div>
                            <span>å‘æ¶ˆæ¯</span>
                        </div>
                        <div class="action-btn">
                            <div class="icon-wrapper">
                                <i class="icon-video"></i>
                            </div>
                            <span>è§†é¢‘é€šè¯</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æœ‹å‹åœˆé¡µé¢ -->
            <div class="page moments-page" :class="{ 'slide-in': showMoments }">
                <!-- æœ‹å‹åœˆå¯¼èˆªæ  -->
                <div class="moments-nav" :style="navStyle">
                    <div class="back-button" @click="closeMoments">
                        <i class="icon-back"></i>
                    </div>
                    <div class="title">æœ‹å‹åœˆ</div>
                    <img src="https://api.iconify.design/material-symbols:photo-camera-outline.svg" class="icon-camera"
                        @click="openCamera">
                </div>

                <!-- æœ‹å‹åœˆå†…å®¹åŒºåŸŸ -->
                <div class="moments-content">
                    <!-- é¡¶éƒ¨èƒŒæ™¯åŒºåŸŸ -->
                    <div class="moments-header">
                        <img class="moments-bg" src="https://picsum.photos/800/600" alt="æœ‹å‹åœˆèƒŒæ™¯">
                        <div class="user-info-moments">
                            <div class="user-name-moments">æˆ‘çš„åå­—</div>
                            <img class="user-avatar-moments" src="https://api.dicebear.com/7.x/avataaars/svg?seed=User"
                                alt="å¤´åƒ">
                        </div>
                    </div>

                    <!-- æœ‹å‹åœˆåˆ—è¡¨ -->
                    <div class="moments-list">
                        <div v-for="moment in moments" :key="moment.id" class="moment-item">
                            <div class="moment-header">
                                <img :src="moment.avatar" :alt="moment.name" class="moment-avatar">
                                <div class="moment-info">
                                    <div class="moment-name">{{ moment.name }}</div>
                                    <div class="moment-text">{{ moment.text }}</div>
                                    <div class="moment-images" v-if="moment.images && moment.images.length">
                                        <img v-for="(image, index) in moment.images" :key="index" :src="image"
                                            class="moment-image" @click="previewImage(moment.images, index)">
                                    </div>
                                    <div class="moment-footer">
                                        <span class="moment-time">{{ moment.time }}</span>
                                        <div class="moment-actions">
                                            <span class="moment-action">èµ</span>
                                            <span class="moment-action">è¯„è®º</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç®€åŒ–çš„å›¾ç‰‡é¢„è§ˆç»„ä»¶ -->
            <div class="image-preview-overlay" v-if="previewImages.length">
                <div class="preview-close" @click="closePreview">Ã—</div>

                <div class="preview-container">
                    <img :src="previewImages[currentPreviewIndex]" class="preview-image" @click="nextImage"
                        @touchstart="handleTouchStart" @touchmove="handleTouchMove" @touchend="handleTouchEnd"
                        @mousedown="handleMouseDown" @mousemove="handleMouseMove" @mouseup="handleMouseUp"
                        @mouseleave="handleMouseUp">
                </div>

                <div class="preview-indicator">{{ currentPreviewIndex + 1 }}/{{ previewImages.length }}</div>
            </div>


            <!-- AIç”»ä¸€ç”»é¡µé¢ -->
            <div class="draw-page" :class="{ 'slide-in': showDrawPage }">
                <!-- é¡¶éƒ¨å¯¼èˆª -->
                <div class="header">
                    <div class="back-button" @click="closeDrawPage"></div>
                    <div class="title">ç”»ä¸€ç”»</div>
                    <div class="right-placeholder"></div>
                </div>

                <!-- æ¨¡æ¿é€‰æ‹© -->
                <div class="template-section">
                    <div class="template-title">é€‰æ‹©æ¨¡æ¿</div>
                    <div class="template-list">
                        <div v-for="template in templates" 
                             :key="template.id"
                             class="template-item"
                             :class="{ active: currentTemplate === template.id }"
                             @click="selectTemplate(template.id)">
                            <div class="template-icon">
                                <img :src="template.icon" :alt="template.name">
                            </div>
                            <div class="template-name">{{template.name}}</div>
                        </div>
                    </div>
                </div>

                <!-- æç¤ºè¯è¾“å…¥ -->
                <div class="prompt-section">
                    <div>è¾“å…¥æç¤ºè¯</div>
                    <div class="prompt-input">
                        <textarea 
                            v-model="prompt"
                            :placeholder="getPlaceholder()"
                            maxlength="1000">
                        </textarea>
                        <div class="word-count">{{ prompt.length }}/1000</div>
                    </div>
                </div>

                <!-- å‚è€ƒå›¾ä¸Šä¼  - ä»…åœ¨ç‰¹å®šæ¨¡æ¿ä¸‹æ˜¾ç¤º -->
                <div class="reference-section" v-if="showReferenceUpload">
                    <div>ä¸Šä¼ å‚è€ƒå›¾</div>
                    <div class="upload-area">
                        <div v-for="(img, index) in referenceImages" 
                             :key="index" 
                             class="upload-item">
                            <img :src="img" class="upload-preview">
                            <div class="upload-remove" @click="removeImage(index)">Ã—</div>
                        </div>
                        <div class="upload-item" v-if="referenceImages.length < maxImages" @click="uploadImage">
                            <i class="plus-icon"></i>
                        </div>
                    </div>
                </div>

                <!-- ç”ŸæˆæŒ‰é’® -->
                <div class="generate-section">
                    <button class="generate-button" @click="generateImage">
                        <i class="icon-magic"></i>
                        <span>å¼€å§‹ç”Ÿæˆ</span>
                    </button>
                </div>
            </div>




        </div>
    </div>



    <!-- Vueå®ä¾‹é…ç½® -->
    <script>
        const { createApp } = Vue;

        const app = createApp({
            data() {
                return {
                    currentTab: 'wechat',
                    tabs: [
                        { id: 'wechat', name: 'å¾®ä¿¡', icon: 'icon-chat' },
                        { id: 'contacts', name: 'é€šè®¯å½•', icon: 'icon-contacts' },
                        { id: 'discover', name: 'å‘ç°', icon: 'icon-discover' },
                        { id: 'me', name: 'æˆ‘', icon: 'icon-me' }
                    ],
                    messageText: '',
                    selectedImages: [],
                    imageFiles: [],
                    chats: [
                        {
                            id: 1,
                            name: 'å¾®ä¿¡å›¢é˜Ÿ',
                            avatar: 'https://api.dicebear.com/7.x/bottts/svg?seed=wx-team',
                            lastMessage: 'æ¬¢è¿ä½¿ç”¨å¾®ä¿¡',
                            time: '12:00',
                            unread: 1,
                            isOfficial: true,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'æ¬¢è¿ä½¿ç”¨å¾®ä¿¡',
                                    isSelf: false,
                                    time: '12:00'
                                }
                            ]
                        },
                        {
                            id: 2,
                            name: 'æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹',
                            avatar: 'https://api.dicebear.com/7.x/bottts/svg?seed=file-helper',
                            lastMessage: 'æ‚¨çš„æ–‡ä»¶å·²å‘é€æˆåŠŸ',
                            time: '11:30',
                            unread: 0,
                            isSystem: true,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'æ‚¨çš„æ–‡ä»¶å·²å‘é€æˆåŠŸ',
                                    isSelf: false,
                                    time: '11:30'
                                }
                            ]
                        },
                        {
                            id: 3,
                            name: 'äº§å“å¼€å‘ç¾¤',
                            avatar: 'https://api.dicebear.com/7.x/initials/svg?seed=äº§å“å¼€å‘ç¾¤',
                            lastMessage: 'Alice: æ–°åŠŸèƒ½å·²ç»ä¸Šçº¿äº†ï¼Œå¤§å®¶å¯ä»¥æµ‹ä¸€ä¸‹',
                            time: '10:45',
                            unread: 12,
                            isGroup: true,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'æ–°åŠŸèƒ½å·²ç»ä¸Šçº¿äº†ï¼Œå¤§å®¶å¯ä»¥æµ‹è¯•ä¸€ä¸‹',
                                    isSelf: false,
                                    time: '10:45',
                                    sender: 'Alice'
                                }
                            ]
                        },
                        {
                            id: 4,
                            name: 'Alice',
                            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alice',
                            lastMessage: 'å¥½çš„ï¼Œä¸‹åˆè§',
                            time: '10:30',
                            unread: 0,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'ä¸‹æœ‰ä¸ªä¼šè®®éœ€è¦è®¨è®º',
                                    isSelf: false,
                                    time: '10:25'
                                },
                                {
                                    id: 2,
                                    type: 'text',
                                    content: 'å¥½çš„ï¼Œä¸‹åˆè§',
                                    isSelf: true,
                                    time: '10:30'
                                }
                            ]
                        },
                        {
                            id: 5,
                            name: 'Bob',
                            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bob',
                            lastMessage: 'é¡¹ç›®è¿›å±•å¦‚ä½•ï¼Ÿ',
                            time: '09:15',
                            unread: 3,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'é¡¹ç›®è¿›å±•å¦‚ä½•ï¼Ÿ',
                                    isSelf: false,
                                    time: '09:15'
                                }
                            ]
                        },
                        {
                            id: 6,
                            name: 'æŠ€æœ¯æ”¯æŒç¾¤',
                            avatar: 'https://api.dicebear.com/7.x/initials/svg?seed=æŠ€æœ¯æ”¯æŒç¾¤',
                            lastMessage: 'Tom: æœåŠ¡å™¨çŠ¶æ€å·²æ¢å¤æ­£å¸¸',
                            time: '09:00',
                            unread: 5,
                            isGroup: true,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'æœåŠ¡çŠ¶æ€å·²æ¢å¤å¸¸',
                                    isSelf: false,
                                    time: '09:00',
                                    sender: 'Tom'
                                }
                            ]
                        },
                        {
                            id: 7,
                            name: 'Emma',
                            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Emma',
                            lastMessage: 'å‘¨æœ«ä¸€èµ·å»çœ‹ç”µå½±å—ï¼Ÿ',
                            time: 'æ˜¨å¤©',
                            unread: 1,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'å‘¨æœ«ä¸€èµ·å»çœ‹ç”µå½±å—ï¼Ÿ',
                                    isSelf: false,
                                    time: 'æ˜¨å¤©'
                                }
                            ]
                        },
                        {
                            id: 8,
                            name: 'å®¶åº­ç¾¤',
                            avatar: 'https://api.dicebear.com/7.x/initials/svg?seed=å®¶åº­ç¾¤',
                            lastMessage: 'å¦ˆå¦ˆï¼šè®°å¾—å›å®¶åƒé¥­',
                            time: 'æ˜¨å¤©',
                            unread: 0,
                            isGroup: true,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'è®°å¾—å›å®¶åƒé¥­',
                                    isSelf: false,
                                    time: 'æ˜¨å¤©',
                                    sender: 'å¦ˆå¦ˆ'
                                }
                            ]
                        },
                        {
                            id: 9,
                            name: 'Jack',
                            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Jack',
                            lastMessage: 'é¡¹ç›®æ–‡æ¡£å·²æ›´æ–°',
                            time: 'æ˜ŸæœŸäºŒ',
                            unread: 0,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'é¡¹ç›®æ–‡æ¡£å·²æ›´æ–°',
                                    isSelf: false,
                                    time: 'æ˜ŸæœŸäºŒ'
                                }
                            ]
                        },
                        {
                            id: 10,
                            name: 'åŒå­¦ä¼šç¾¤',
                            avatar: 'https://api.dicebear.com/7.x/initials/svg?seed=åŒå­¦ä¼šç¾¤',
                            lastMessage: 'Lisa: ä¸‹ä¸ªæœˆèšä¼šæ—¶é—´å®šäº†å—ï¼Ÿ',
                            time: 'æ˜ŸæœŸä¸€',
                            unread: 8,
                            isGroup: true,
                            messages: [
                                {
                                    id: 1,
                                    type: 'text',
                                    content: 'ä¸‹ä¸ªæœˆèšä¼šæ—¶é—´å®šäº†å—ï¼Ÿ',
                                    isSelf: false,
                                    time: 'æ˜ŸæœŸä¸€',
                                    sender: 'Lisa'
                                }
                            ]
                        }
                    ],
                    showChat: false,
                    currentChat: null,
                    showContactDetail: false,
                    currentContact: null,
                    letters: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'],
                    contactSections: [
                        {
                            letter: 'A',
                            contacts: [
                                {
                                    id: 1,
                                    name: 'Alice',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alice',
                                    region: 'å¹¿ä¸œ æ·±åœ³'
                                },
                                {
                                    id: 2,
                                    name: 'Amy',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Amy',
                                    region: 'åŒ—äº¬'
                                },
                                {
                                    id: 3,
                                    name: 'Alex',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alex',
                                    region: 'ä¸Šæµ·'
                                }
                            ]
                        },
                        {
                            letter: 'B',
                            contacts: [
                                {
                                    id: 4,
                                    name: 'Bob',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bob',
                                    region: 'ä¸Šæµ·'
                                },
                                {
                                    id: 5,
                                    name: 'Bill',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bill',
                                    region: 'å¹¿ä¸œ å¹¿å·'
                                },
                                {
                                    id: 6,
                                    name: 'Bruce',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bruce',
                                    region: 'æµ™æ±Ÿ æ­å·'
                                }
                            ]
                        },
                        {
                            letter: 'C',
                            contacts: [
                                {
                                    id: 7,
                                    name: 'Cindy',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Cindy',
                                    region: 'æµ™æ±Ÿ æ­å·'
                                },
                                {
                                    id: 8,
                                    name: 'Chris',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Chris',
                                    region: 'æ±Ÿè‹ å—äº¬'
                                }
                            ]
                        },
                        {
                            letter: 'D',
                            contacts: [
                                {
                                    id: 9,
                                    name: 'David',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=David',
                                    region: 'å››å· æˆéƒ½'
                                },
                                {
                                    id: 10,
                                    name: 'Daniel',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Daniel',
                                    region: 'æ¹–åŒ— æ­¦æ±‰'
                                }
                            ]
                        },
                        {
                            letter: 'L',
                            contacts: [
                                {
                                    id: 11,
                                    name: 'Lucy',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Lucy',
                                    region: 'ç¦å»º å¦é—¨'
                                },
                                {
                                    id: 12,
                                    name: 'Linda',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Linda',
                                    region: 'å±±ä¸œ é’å²›'
                                }
                            ]
                        },
                        {
                            letter: 'M',
                            contacts: [
                                {
                                    id: 13,
                                    name: 'Mike',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Mike',
                                    region: 'æ±Ÿè¥¿ å—æ˜Œ'
                                },
                                {
                                    id: 14,
                                    name: 'Mary',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Mary',
                                    region: 'å®‰å¾½ åˆè‚¥'
                                }
                            ]
                        },
                        {
                            letter: 'S',
                            contacts: [
                                {
                                    id: 15,
                                    name: 'Sarah',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Sarah',
                                    region: 'é‡åº†'
                                },
                                {
                                    id: 16,
                                    name: 'Steve',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Steve',
                                    region: 'å¤©æ´¥'
                                }
                            ]
                        },
                        {
                            letter: 'W',
                            contacts: [
                                {
                                    id: 17,
                                    name: 'William',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=William',
                                    region: 'æ²³åŒ— çŸ³å®¶åº„'
                                },
                                {
                                    id: 18,
                                    name: 'Wendy',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Wendy',
                                    region: 'è¥¿ è¥¿å®‰'
                                }
                            ]
                        },
                        {
                            letter: 'Z',
                            contacts: [
                                {
                                    id: 19,
                                    name: 'Zack',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Zack',
                                    region: 'æ¹–å— é•¿æ²™'
                                },
                                {
                                    id: 20,
                                    name: 'Zoey',
                                    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Zoey',
                                    region: 'äº‘å— æ˜†æ˜'
                                }
                            ]
                        }
                    ],
                    searchText: '', // æœç´¢æ–‡æœ¬
                    searchResults: [], // æœç´¢ç»“æœ
                    showMoments: false,
                    isNavScrolled: false,
                    moments: [
                        {
                            id: 1,
                            name: "å¼ ä¸‰",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Alice",
                            text: "ä»Šå¤©å¤©æ°”çœŸå¥½ â˜€ï¸",
                            images: [
                                "https://picsum.photos/300/300?random=1",
                                "https://picsum.photos/300/300?random=2",
                                "https://picsum.photos/300/300?random=3"
                            ],
                            time: "5åˆ†é’Ÿå‰"
                        },
                        {
                            id: 2,
                            name: "æå››",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Bob",
                            text: "åˆ†äº«ä¸€ä¸ªæœ‰è¶£çš„é¡¹ç›® ğŸš€",
                            images: [
                                "https://picsum.photos/300/300?random=4"
                            ],
                            time: "10åˆ†é’Ÿå‰"
                        },
                        {
                            id: 3,
                            name: "å°æ˜",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Charlie",
                            text: "å‘¨æœ«å»çˆ¬å±±ï¼Œé£æ™¯çœŸç¾ ğŸ”ï¸",
                            images: [
                                "https://picsum.photos/300/300?random=5",
                                "https://picsum.photos/300/300?random=6",
                                "https://picsum.photos/300/300?random=7",
                                "https://picsum.photos/300/300?random=8"
                            ],
                            time: "1å°æ—¶å‰"
                        },
                        {
                            id: 4,
                            name: "å°çº¢",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=David",
                            text: "æ–°ä¹°çš„ç›¸æœºï¼Œéšæ‰‹æ‹å‡ å¼  ğŸ“¸",
                            images: [
                                "https://picsum.photos/300/300?random=9",
                                "https://picsum.photos/300/300?random=10"
                            ],
                            time: "2å°æ—¶å‰"
                        },
                        {
                            id: 5,
                            name: "ç‹äº”",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Eva",
                            text: "ç¾é£Ÿåˆ†äº« ğŸœ",
                            images: [
                                "https://picsum.photos/300/300?random=11",
                                "https://picsum.photos/300/300?random=12",
                                "https://picsum.photos/300/300?random=13",
                                "https://picsum.photos/300/300?random=14",
                                "https://picsum.photos/300/300?random=15"
                            ],
                            time: "3å°æ—¶å‰"
                        },
                        {
                            id: 6,
                            name: "å°æ",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Frank",
                            text: "å·¥ä½œæ—¥å¸¸ ğŸ’¼",
                            time: "4å°æ—¶å‰"
                        },
                        {
                            id: 7,
                            name: "å°å¼ ",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=George",
                            text: "æ–°åˆ°çš„å’–å•¡è±†ï¼Œé¦™æ°”å››æº¢ â˜•ï¸",
                            images: [
                                "https://picsum.photos/300/300?random=16"
                            ],
                            time: "5å°æ—¶å‰"
                        },
                        {
                            id: 8,
                            name: "å°ç‹",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Henry",
                            text: "è¯»ä¹¦æ‰“å¡ç¬¬100å¤© ğŸ“š",
                            time: "6å°æ—¶å‰"
                        },
                        {
                            id: 9,
                            name: "å°é™ˆ",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Ivy",
                            text: "çœ‹å±•è§ˆçš„ä¸€å¤© ğŸ¨",
                            images: [
                                "https://picsum.photos/300/300?random=17",
                                "https://picsum.photos/300/300?random=18",
                                "https://picsum.photos/300/300?random=19"
                            ],
                            time: "8å°æ—¶å‰"
                        },
                        {
                            id: 10,
                            name: "å°æ—",
                            avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Jack",
                            text: "æ–°å­¦æœŸå¼€å§‹äº† ğŸ“",
                            images: [
                                "https://picsum.photos/300/300?random=20",
                                "https://picsum.photos/300/300?random=21"
                            ],
                            time: "10å°æ—¶å‰"
                        }
                    ],
                    scrollTop: 0,  // æ·»åŠ æ»šåŠ¨ä½ç½®è®°å½•
                    previewImages: [], // é¢„è§ˆå›¾ç‰‡æ•°ç»„
                    currentPreviewIndex: 0, // å½“å‰é¢„è§ˆçš„å›¾ç‰‡ç´¢å¼•
                    startX: 0,
                    endX: 0,
                    isDragging: false,
                    isMoved: false,

                    /*ç”»ä¸€ç”»*/
                    showDrawPage: false,
                    drawPrompt: '',
                    similarity: 75,
                    currentStyle: 'æ¨è',
                    styles: ['æ¨è', 'åŠ¨æ¼«', 'åˆ›æ„è‰ºæœ¯', 'äººç‰©å†™å®', 'æ›´å¤š'],
                    templates: [
                        { 
                            id: 'all', 
                            name: 'å…¨èƒ½',
                            icon: 'https://api.iconify.design/material-symbols:auto-awesome.svg?color=%238E5CFF',
                            placeholder: 'è¯·æè¿°æ‚¨æƒ³è¦çš„ç”»é¢ï¼Œä¾‹å¦‚ï¼šæ˜Ÿç©ºä¸‹çš„åŸå¸‚å¤œæ™¯ï¼Œéœ“è™¹ç¯é—ªçƒ'
                        },
                        { 
                            id: 'photo', 
                            name: 'å†™çœŸ',
                            icon: 'https://api.iconify.design/material-symbols:photo-camera.svg?color=%238E5CFF',
                            placeholder: 'è¯·æè¿°äººç‰©ç‰¹å¾å’Œåœºæ™¯ï¼Œä¾‹å¦‚ï¼šå¹´è½»å¥³å­©ï¼Œç™½è‰²è¿è¡£è£™ï¼Œæ¨±èŠ±æ—'
                        },
                        { 
                            id: 'interior', 
                            name: 'è£…ä¿®',
                            icon: 'https://api.iconify.design/material-symbols:chair.svg?color=%238E5CFF',
                            placeholder: 'è¯·æè¿°è£…ä¿®é£æ ¼å’Œç©ºé—´ï¼Œä¾‹å¦‚ï¼šç°ä»£ç®€çº¦å®¢å…ï¼Œå¤§è½åœ°çª—ï¼Œç°ç™½è‰²è°ƒ'
                        },
                        { 
                            id: 'commerce', 
                            name: 'ç”µå•†',
                            icon: 'https://api.iconify.design/material-symbols:shopping-bag.svg?color=%238E5CFF',
                            placeholder: 'è¯·æè¿°å•†å“å±•ç¤ºéœ€æ±‚ï¼Œä¾‹å¦‚ï¼šç™½è‰²é™¶ç“·å’–å•¡æ¯ï¼Œç®€çº¦é£æ ¼äº§å“å›¾'
                        },
                        { 
                            id: 'ad', 
                            name: 'å¹¿å‘Š',
                            icon: 'https://api.iconify.design/material-symbols:ads-click.svg?color=%238E5CFF',
                            placeholder: 'è¯·æè¿°å¹¿å‘Šåˆ›æ„ï¼Œä¾‹å¦‚ï¼šè¿åŠ¨é‹å¹¿å‘Šï¼Œå……æ»¡åŠ¨æ„Ÿï¼Œå¹´è½»æ´»åŠ›'
                        }
                    ],
                    currentTemplate: 'all',
                    prompt: '',
                    referenceImages: [],
                    maxImages: 4,
                    showReferenceUpload: false
                }
            },
            methods: {
                switchTab(tabId) {
                    this.currentTab = tabId;
                },
                openChat(chat) {
                    this.currentChat = chat;
                    this.showChat = true;

                    // æ¸…é™¤æœªè¯»æ¶ˆæ¯æé†’
                    if (chat.unread) {
                        chat.unread = 0;  // å°†æœªè¯»æ¶ˆæ¯æ•°é‡ç½®ä¸º0
                    }

                    // æ»šåŠ¨åˆ°åº•éƒ¨
                    this.$nextTick(() => {
                        const chatContent = document.querySelector('.chat-content');
                        if (chatContent) {
                            chatContent.scrollTop = chatContent.scrollHeight;
                        }
                    });
                },
                goBack() {
                    // å…³é—­èŠå¤©é¡µé¢
                    this.showChat = false;
                    this.currentChat = null;
                    // ç›´æ¥åˆ‡æ¢åˆ°å¾®ä¿¡æ ‡ç­¾é¡µ
                    this.currentTab = 'wechat';
                },
                handleImageSelect(event) {
                    const files = Array.from(event.target.files);
                    files.forEach(file => {
                        if (file) {
                            this.imageFiles.push(file);
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                this.selectedImages.push(e.target.result);
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    event.target.value = '';
                },
                cancelImage(index) {
                    this.selectedImages.splice(index, 1);
                    this.imageFiles.splice(index, 1);
                },
                sendMessage() {
                    if (!this.currentChat) {
                        console.warn('No current chat selected');
                        return;
                    }

                    if (!this.currentChat.messages) {
                        this.currentChat.messages = [];
                    }

                    if (this.messageText.trim() || this.selectedImages.length) {
                        if (this.messageText.trim()) {
                            const textMessage = {
                                id: Date.now(),
                                type: 'text',
                                content: this.messageText,
                                isSelf: true,
                                time: new Date().toLocaleTimeString()
                            };
                            this.currentChat.messages.push(textMessage);
                            // æ›´æ–°æœ€åä¸€æ¯
                            this.currentChat.lastMessage = this.messageText;
                            this.currentChat.time = new Date().toLocaleTimeString();
                        }

                        this.selectedImages.forEach((image, index) => {
                            const imageMessage = {
                                id: Date.now() + index + 1,
                                type: 'image',
                                content: image,
                                isSelf: true,
                                time: new Date().toLocaleTimeString()
                            };
                            this.currentChat.messages.push(imageMessage);
                            // å¦‚æœæ˜¯æœ€åä¸€å¼ å›¾ç‰‡ï¼Œæ›´æ–°æœ€åä¸€æ¡æ¶ˆæ¯
                            if (index === this.selectedImages.length - 1) {
                                this.currentChat.lastMessage = '[å›¾ç‰‡]';
                                this.currentChat.time = new Date().toLocaleTimeString();
                            }
                        });

                        this.messageText = '';
                        this.selectedImages = [];
                        this.imageFiles = [];

                        this.$nextTick(() => {
                            const chatContent = document.querySelector('.chat-content');
                            if (chatContent) {
                                chatContent.scrollTop = chatContent.scrollHeight;
                            }
                        });
                    }
                },
                openContactDetail(contact) {
                    this.currentContact = contact;
                    this.showContactDetail = true;
                },
                closeContactDetail() {
                    this.showContactDetail = false;
                    this.selectedContact = null;
                    // è¿”å›åˆ°å¾®ä¿¡æ ‡ç­¾é¡µ
                    this.activeTab = 'chats';
                },
                startChat(contact) {
                    this.closeContactDetail();
                    let chat = this.chats.find(c => c.id === contact.id);
                    if (!chat) {
                        chat = {
                            id: contact.id,
                            name: contact.name,
                            avatar: contact.avatar,
                            lastMessage: '',
                            time: new Date().toLocaleTimeString()
                        };
                        this.chats.unshift(chat);
                    }
                    this.openChat(chat);
                },
                scrollToLetter(letter) {
                    const element = document.querySelector(`[data-letter="${letter}"]`);
                    if (element) {
                        const container = document.querySelector('.contact-list');
                        const containerRect = container.getBoundingClientRect();
                        const elementRect = element.getBoundingClientRect();
                        const offset = elementRect.top - containerRect.top;

                        container.scrollTo({
                            top: container.scrollTop + offset - 60, // è€ƒè™‘é¡¶éƒ¨å›ºå®šåŒºåŸŸé«˜åº¦
                            behavior: 'smooth'
                        });
                    }
                },
                handleLetterTouchStart(event, letter) {
                    event.preventDefault();
                    this.scrollToLetter(letter);
                },
                receiveMessage(chatId, message) {
                    const chat = this.chats.find(c => c.id === chatId);
                    if (chat) {
                        if (!chat.messages) {
                            chat.messages = [];
                        }
                        chat.messages.push(message);
                        chat.lastMessage = message.content;
                        chat.time = new Date().toLocaleTimeString();

                        // å¦‚æœä¸æ˜¯å½“å‰èŠå¤©ï¼Œå¢åŠ æœªè¯»æ¶ˆæ¯æ•°
                        if (this.currentChat?.id !== chat.id) {
                            chat.unread = (chat.unread || 0) + 1;
                        }
                    }
                },
                // å¤„ç†æœç´¢
                handleSearch() {
                    if (!this.searchText) {
                        this.searchResults = [];
                        return;
                    }

                    this.searchResults = this.contactSections.reduce((results, section) => {
                        return results.concat(section.contacts.filter(contact => contact.name.toLowerCase().includes(this.searchText.toLowerCase())));
                    }, []);
                },
                openMoments() {
                    this.showMoments = true;
                    this.showChat = false;
                    this.isNavWhite = false; // é‡ç½®å¯¼èˆªæ çŠ¶æ€
                },

                closeMoments() {
                    this.showMoments = false;
                },

                openCamera() {
                    // å®ç°æ‹ç…§åŠŸèƒ½
                    console.log('æ‰“å¼€æœº');
                },

                previewImage(images, index = 0) {
                    // å¦‚æœä¼ å…¥çš„æ˜¯å•å¼ ç‰‡ï¼Œå°†å…¶è½¬æ¢ä¸ºæ•°ç»„
                    this.previewImages = Array.isArray(images) ? images : [images];
                    this.currentPreviewIndex = index;

                    // ç¦æ­¢èƒŒæ™¯æ»šåŠ¨
                    document.body.style.overflow = 'hidden';
                },
                closePreview() {
                    this.previewImages = [];
                    this.currentPreviewIndex = 0;

                    // æ¢å¤èƒŒæ™¯æ»šåŠ¨
                    document.body.style.overflow = 'auto';
                },
                testClick() {
                    console.log('ç‚¹å‡»äº†æœ‹å‹åœˆ');
                },
                nextImage() {
                    if (this.currentPreviewIndex < this.previewImages.length - 1) {
                        this.currentPreviewIndex++;
                    } else {
                        this.currentPreviewIndex = 0; // å¾ªç¯åˆ°ç¬¬ä¸€å¼ 
                    }
                },
                handleTouchStart(event) {
                    this.startX = event.touches[0].clientX;
                    this.isDragging = true;
                    this.isMoved = false; // æ·»åŠ ç§»åŠ¨æ ‡è®°
                },
                handleTouchMove(event) {
                    if (this.isDragging) {
                        event.preventDefault();
                        this.isMoved = true; // æ ‡è®°å·²ç»ç§»åŠ¨
                    }
                },
                handleTouchEnd(event) {
                    if (!this.isDragging) return;

                    // åªæœ‰å‘ç”Ÿäº†ç§»åŠ¨æ‰å¤„ç†æ»‘åŠ¨
                    if (this.isMoved) {
                        this.endX = event.changedTouches[0].clientX;
                        this.handleSwipe();
                    }

                    this.isDragging = false;
                    this.isMoved = false;
                },
                handleMouseDown(event) {
                    this.startX = event.clientX;
                    this.isDragging = true;
                    this.isMoved = false; // æ·»åŠ ç§»åŠ¨æ ‡è®°
                },
                handleMouseMove(event) {
                    if (this.isDragging) {
                        event.preventDefault();
                        this.isMoved = true; // æ ‡è®°å·²ç»ç§»åŠ¨
                    }
                },
                handleMouseUp(event) {
                    if (!this.isDragging) return;

                    // åªæœ‰å‘ç”Ÿäº†ç§»åŠ¨æ‰å¤„ç†æ»‘åŠ¨
                    if (this.isMoved) {
                        this.endX = event.clientX;
                        this.handleSwipe();
                    }

                    this.isDragging = false;
                    this.isMoved = false;
                },
                handleSwipe() {
                    const swipeDistance = this.startX - this.endX;

                    if (Math.abs(swipeDistance) > 5) {
                        if (swipeDistance > 0) {
                            // å‘å·¦æ»‘åŠ¨ï¼Œæ˜¾ç¤ºä¸‹ä¸€å¼ 
                            this.nextImage();
                        } else {
                            // å‘å³æ»‘åŠ¨ï¼Œæ˜¾ç¤ºä¸Šä¸€å¼ 
                            if (this.currentPreviewIndex > 0) {
                                this.currentPreviewIndex--;
                            } else {
                                this.currentPreviewIndex = this.previewImages.length - 1;
                            }
                        }
                    }
                },

                /*ç”»ä¸€ç”»*/
                openDrawPage() {
                    this.showDrawPage = true;
                },
                closeDrawPage() {
                    this.showDrawPage = false;
                },
                clearPrompt() {
                    this.drawPrompt = '';
                },
                generateImage() {
                    // å®ç°å›¾ç‰‡ç”Ÿæˆé€»è¾‘
                    console.log('Generating image with:', {
                        template: this.currentTemplate,
                        prompt: this.prompt,
                        referenceImages: this.referenceImages
                    });
                },
                // è·å–å½“å‰æ¨¡æ¿çš„æç¤ºæ–‡æœ¬
                getPlaceholder() {
                    const template = this.templates.find(t => t.id === this.currentTemplate);
                    return template ? template.placeholder : 'è¯·è¾“å…¥æ‚¨æƒ³è¦å®ç°çš„ç”»é¢å†…å®¹...';
                },
                // é€‰æ‹©æ¨¡æ¿
                selectTemplate(templateId) {
                    this.currentTemplate = templateId;
                    // æ ¹æ®æ¨¡æ¿ç±»å‹å†³å®šæ˜¯å¦æ˜¾ç¤ºå‚è€ƒå›¾ä¸Šä¼ 
                    this.showReferenceUpload = ['photo', 'interior'].includes(templateId);
                },
                // ä¸Šä¼ å›¾ç‰‡
                uploadImage() {
                    // å®ç°å›¾ç‰‡ä¸Šä¼ é€»è¾‘
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = 'image/*';
                    input.onchange = (e) => {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                this.referenceImages.push(e.target.result);
                            };
                            reader.readAsDataURL(file);
                        }
                    };
                    input.click();
                },
                // ç§»é™¤å›¾ç‰‡
                removeImage(index) {
                    this.referenceImages.splice(index, 1);
                }
            },
            computed: {
                getCurrentTabName() {
                    const currentTab = this.tabs.find(tab => tab.id === this.currentTab);
                    return currentTab ? currentTab.name : 'ä¿¡';
                }
            }
        });

        app.mount('#app');
    </script>
</body>

</html>